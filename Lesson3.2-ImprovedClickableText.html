<!DOCTYPE html>
<html>

<head>
    <meta charset="utf-8">
    <title>Improved Selectable Text</title>
    <style type="text/css" media="screen">

    .active{
      color: red
    }

    .inactive{
      color: green
    }

    </style>
</head>

<body>


<div id="document" style="min-height: 200px; border: 1px solid black;"
     ondragenter="document.getElementById('document').textContent = ''; event.stopPropagation(); event.preventDefault();"
     ondragover="event.stopPropagation(); event.preventDefault();"
     ondrop="event.stopPropagation(); event.preventDefault();
     dodrop(event);">
     Drag&Drop some text file here...
</div>

<script id="clicableText">
function myOnClick(e) {
  if (e.srcElement.id === "document") {
    // TODO: fix mouse selection
    return;
  }

  if (e.srcElement.className === 'active'){
    console.log("Elem #"+e.srcElement.id+" inactive");
    e.srcElement.className = 'inactive';
  } else {
    console.log("Elem #"+e.srcElement.id+" active");
    e.srcElement.className = 'active';
  }
}

let doc = document.getElementById("document");
doc.addEventListener('click', myOnClick);

var idx = 10;

function addText(text)
{
  var words = text.split(/\s+/);
  for (const word of words) {
    let span = document.createElement('span');
    span.textContent = word;
    //span.innerHTML = word;
    span.id = idx++;

    doc.appendChild(span);
    doc.appendChild(document.createTextNode(" "));
  }
}
</script>

<script id="drag&drop">
//https://developer.mozilla.org/en-US/docs/Web/API/HTML_Drag_and_Drop_API
function dodrop(event)
{
  var dt = event.dataTransfer;
  var files = dt.files;
/*
  var count = files.length;
  output("File Count: " + count + "\n");

    for (var i = 0; i < files.length; i++) {
      output(" File " + i + ":\n(" + (typeof files[i]) + ") : <" + files[i] + " > " +
             files[i].name + " " + files[i].size + "\n");
    }
*/
  var file = event.dataTransfer.files[0],
  reader = new FileReader();
  reader.onload = function (event) {
    //console.log(event.target.result);
    //holder.style.background = 'url(' + event.target.result + ') no-repeat center';
    //output(event.target.result);
    addText(event.target.result);
  };
  console.log("Reading " + file.name);

  reader.readAsText(file);
}

function output(text)
{
  document.getElementById("output").textContent += text;
  //dump(text);
}
</script>

</body>
</html>
